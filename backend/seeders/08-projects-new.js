'use strict';

module.exports = {
  up: async (queryInterface, Sequelize) => {
    // Get user IDs for implementing offices
    const users = await queryInterface.sequelize.query(
      `SELECT id, role, subRole FROM users WHERE role IN ('LGU-IU', 'EIU') LIMIT 5`,
      { type: Sequelize.QueryTypes.SELECT }
    );

    const implementingOffices = users.filter(user => user.role === 'LGU-IU');
    const eiuUsers = users.filter(user => user.role === 'EIU');

    if (implementingOffices.length === 0) {
      console.log('No implementing office users found. Skipping projects seeder.');
      return;
    }

    const projects = [
      {
        id: '660e8400-e29b-41d4-a716-446655440001',
        projectCode: 'PRJ-2025-450618',
        name: 'Installation of Additional Security Cameras (and other parts) for Monitoring of Disaster-prone Areas',
        implementingOfficeName: 'Municipal Disaster And Risk Reduction Management Office',
        description: 'Installation of security cameras and monitoring equipment in disaster-prone areas to enhance surveillance and early warning capabilities.',
        category: 'infrastructure',
        location: 'Various Disaster-prone Areas, Santa Cruz, Laguna',
        priority: 'high',
        fundingSource: 'local_fund',
        createdDate: '2025-01-15',
        status: 'ongoing',
        expectedOutputs: 'Enhanced monitoring system for disaster-prone areas',
        targetBeneficiaries: 'Residents in disaster-prone areas',
        hasExternalPartner: false,
        startDate: '2025-01-20',
        endDate: '2025-06-30',
        timelineUpdateFrequency: 'weekly',
        timelineMilestones: 'Site survey, equipment procurement, installation, testing, commissioning',
        timelineProgress: 15.00,
        totalBudget: 1726690.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Equipment: 70%, Installation: 20%, Testing: 10%',
        budgetProgress: 12.50,
        physicalUpdateFrequency: 'weekly',
        requiredDocumentation: 'Installation reports, testing certificates, user manuals',
        physicalProgressRequirements: 'Camera installation, wiring, testing',
        physicalProgress: 15.00,
        overallProgress: 15.00,
        projectManager: 'Engr. Juan Dela Cruz',
        contactNumber: '09123456789',
        specialRequirements: 'Weather-resistant equipment, backup power systems',
        implementingOfficeId: implementingOffices[0]?.id,
        approvedBySecretariat: true,
        approvedByMPMEC: false,
        workflowStatus: 'ongoing',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-10'),
        secretariatApprovalDate: new Date('2025-01-15'),
        createdAt: new Date('2025-01-15'),
        updatedAt: new Date('2025-01-15')
      },
      {
        id: '660e8400-e29b-41d4-a716-446655440002',
        projectCode: 'PRJ-2025-549469',
        name: 'Provision of Localized Pantawid Pamilyang Pilipino Program',
        implementingOfficeName: 'Municipal Social Welfare And Development Office',
        description: 'Implementation of localized 4Ps program to provide conditional cash transfers to eligible families.',
        category: 'social',
        location: 'Municipality-wide, Santa Cruz, Laguna',
        priority: 'high',
        fundingSource: 'national_fund',
        createdDate: '2025-01-10',
        status: 'ongoing',
        expectedOutputs: 'Improved living conditions for beneficiary families',
        targetBeneficiaries: 'Eligible families in poverty',
        hasExternalPartner: false,
        startDate: '2025-01-15',
        endDate: '2025-12-31',
        timelineUpdateFrequency: 'monthly',
        timelineMilestones: 'Beneficiary identification, registration, cash distribution, monitoring',
        timelineProgress: 0.00,
        totalBudget: 2000000.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Cash transfers: 90%, Administrative: 10%',
        budgetProgress: 0.00,
        physicalUpdateFrequency: 'monthly',
        requiredDocumentation: 'Beneficiary lists, distribution reports, monitoring reports',
        physicalProgressRequirements: 'Family registration, cash distribution',
        physicalProgress: 0.00,
        overallProgress: 0.00,
        projectManager: 'Ms. Maria Santos',
        contactNumber: '09187654321',
        specialRequirements: 'Secure cash handling, beneficiary verification',
        implementingOfficeId: implementingOffices[1]?.id || implementingOffices[0]?.id,
        approvedBySecretariat: true,
        approvedByMPMEC: false,
        workflowStatus: 'ongoing',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-05'),
        secretariatApprovalDate: new Date('2025-01-10'),
        createdAt: new Date('2025-01-10'),
        updatedAt: new Date('2025-01-10')
      },
      {
        id: '660e8400-e29b-41d4-a716-446655440003',
        projectCode: 'PRJ-2025-044690',
        name: 'Provision of Social Pension Program for Indigent Senior Citizens',
        implementingOfficeName: 'Municipal Social Welfare And Development Office',
        description: 'Monthly pension distribution to indigent senior citizens to support their basic needs.',
        category: 'social',
        location: 'Municipality-wide, Santa Cruz, Laguna',
        priority: 'high',
        fundingSource: 'local_fund',
        createdDate: '2025-01-05',
        status: 'ongoing',
        expectedOutputs: 'Improved quality of life for senior citizens',
        targetBeneficiaries: 'Indigent senior citizens (60 years and above)',
        hasExternalPartner: false,
        startDate: '2025-01-10',
        endDate: '2025-12-31',
        timelineUpdateFrequency: 'monthly',
        timelineMilestones: 'Beneficiary identification, registration, monthly distribution',
        timelineProgress: 0.00,
        totalBudget: 1500000.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Pension payments: 95%, Administrative: 5%',
        budgetProgress: 0.00,
        physicalUpdateFrequency: 'monthly',
        requiredDocumentation: 'Beneficiary lists, distribution reports',
        physicalProgressRequirements: 'Monthly pension distribution',
        physicalProgress: 0.00,
        overallProgress: 0.00,
        projectManager: 'Ms. Ana Reyes',
        contactNumber: '09123456788',
        specialRequirements: 'Secure cash handling, beneficiary verification',
        implementingOfficeId: implementingOffices[1]?.id || implementingOffices[0]?.id,
        approvedBySecretariat: true,
        approvedByMPMEC: false,
        workflowStatus: 'ongoing',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-01'),
        secretariatApprovalDate: new Date('2025-01-05'),
        createdAt: new Date('2025-01-05'),
        updatedAt: new Date('2025-01-05')
      },
      {
        id: '660e8400-e29b-41d4-a716-446655440004',
        projectCode: 'PRJ-2025-115390',
        name: 'Procurement of Garbage Truck 20 CBM Collecting 10 Wheeler Dump Truck',
        implementingOfficeName: 'Municipal Environment and Natural Resources Office',
        description: 'Procurement of garbage collection truck to improve waste management services.',
        category: 'infrastructure',
        location: 'Municipality-wide, Santa Cruz, Laguna',
        priority: 'medium',
        fundingSource: 'local_fund',
        createdDate: '2025-01-08',
        status: 'ongoing',
        expectedOutputs: 'Improved waste collection services',
        targetBeneficiaries: 'All residents and businesses',
        hasExternalPartner: true,
        eiuPersonnelId: eiuUsers[0]?.id,
        startDate: '2025-01-15',
        endDate: '2025-05-31',
        timelineUpdateFrequency: 'weekly',
        timelineMilestones: 'Procurement, delivery, testing, deployment',
        timelineProgress: 0.00,
        totalBudget: 8000000.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Vehicle: 85%, Training: 10%, Maintenance: 5%',
        budgetProgress: 0.00,
        physicalUpdateFrequency: 'weekly',
        requiredDocumentation: 'Procurement documents, delivery reports, testing certificates',
        physicalProgressRequirements: 'Vehicle procurement and delivery',
        physicalProgress: 0.00,
        overallProgress: 0.00,
        projectManager: 'Engr. Pedro Martinez',
        contactNumber: '09187654322',
        specialRequirements: 'Heavy equipment certification, operator training',
        implementingOfficeId: implementingOffices[2]?.id || implementingOffices[0]?.id,
        approvedBySecretariat: true,
        approvedByMPMEC: false,
        workflowStatus: 'ongoing',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-03'),
        secretariatApprovalDate: new Date('2025-01-08'),
        createdAt: new Date('2025-01-08'),
        updatedAt: new Date('2025-01-08')
      },
      {
        id: '660e8400-e29b-41d4-a716-446655440005',
        projectCode: 'PRJ-2025-223456',
        name: 'Municipal Health Center Expansion and Modernization',
        implementingOfficeName: 'Municipal Health Office',
        description: 'Expansion and modernization of the municipal health center to accommodate more patients and modern medical equipment.',
        category: 'health',
        location: 'Municipal Health Center, Santa Cruz, Laguna',
        priority: 'high',
        fundingSource: 'mixed_fund',
        createdDate: '2025-01-12',
        status: 'ongoing',
        expectedOutputs: 'Expanded and modernized health center',
        targetBeneficiaries: 'Local residents requiring medical services',
        hasExternalPartner: false,
        startDate: '2025-01-20',
        endDate: '2025-08-31',
        timelineUpdateFrequency: 'weekly',
        timelineMilestones: 'Design, construction, equipment installation, testing',
        timelineProgress: 25.00,
        totalBudget: 12000000.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Construction: 60%, Equipment: 30%, Administrative: 10%',
        budgetProgress: 20.00,
        physicalUpdateFrequency: 'weekly',
        requiredDocumentation: 'Construction permits, progress reports, equipment certificates',
        physicalProgressRequirements: 'Building construction, equipment installation',
        physicalProgress: 25.00,
        overallProgress: 25.00,
        projectManager: 'Dr. Maria Garcia',
        contactNumber: '09123456787',
        specialRequirements: 'Medical equipment certification, safety compliance',
        implementingOfficeId: implementingOffices[3]?.id || implementingOffices[0]?.id,
        approvedBySecretariat: true,
        approvedByMPMEC: false,
        workflowStatus: 'ongoing',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-07'),
        secretariatApprovalDate: new Date('2025-01-12'),
        createdAt: new Date('2025-01-12'),
        updatedAt: new Date('2025-01-12')
      },
      {
        id: '660e8400-e29b-41d4-a716-446655440006',
        projectCode: 'PRJ-2025-334567',
        name: 'Agricultural Support and Training Program',
        implementingOfficeName: 'Municipal Agriculture Office',
        description: 'Comprehensive support program for local farmers including training, equipment, and market access.',
        category: 'agriculture',
        location: 'Various Barangays, Santa Cruz, Laguna',
        priority: 'medium',
        fundingSource: 'national_fund',
        createdDate: '2025-01-14',
        status: 'ongoing',
        expectedOutputs: 'Trained farmers with improved farming techniques',
        targetBeneficiaries: 'Local farmers and agricultural workers',
        hasExternalPartner: false,
        startDate: '2025-01-25',
        endDate: '2025-11-30',
        timelineUpdateFrequency: 'monthly',
        timelineMilestones: 'Farmer identification, training, equipment distribution, monitoring',
        timelineProgress: 10.00,
        totalBudget: 5000000.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Training: 40%, Equipment: 40%, Administrative: 20%',
        budgetProgress: 8.00,
        physicalUpdateFrequency: 'monthly',
        requiredDocumentation: 'Training reports, equipment distribution lists, monitoring reports',
        physicalProgressRequirements: 'Farmer training, equipment distribution',
        physicalProgress: 10.00,
        overallProgress: 10.00,
        projectManager: 'Mr. Jose Santos',
        contactNumber: '09187654323',
        specialRequirements: 'Agricultural expertise, equipment maintenance',
        implementingOfficeId: implementingOffices[4]?.id || implementingOffices[0]?.id,
        approvedBySecretariat: true,
        approvedByMPMEC: false,
        workflowStatus: 'ongoing',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-09'),
        secretariatApprovalDate: new Date('2025-01-14'),
        createdAt: new Date('2025-01-14'),
        updatedAt: new Date('2025-01-14')
      },
      {
        id: '660e8400-e29b-41d4-a716-446655440007',
        projectCode: 'PRJ-2025-445678',
        name: 'Municipal School Building Construction',
        implementingOfficeName: 'Municipal Engineering Office',
        description: 'Construction of additional classrooms and facilities for the municipal elementary school.',
        category: 'education',
        location: 'Santa Cruz Elementary School, Santa Cruz, Laguna',
        priority: 'high',
        fundingSource: 'local_fund',
        createdDate: '2025-01-16',
        status: 'pending',
        expectedOutputs: 'New school building with modern facilities',
        targetBeneficiaries: 'Elementary school students and teachers',
        hasExternalPartner: true,
        eiuPersonnelId: eiuUsers[1]?.id || eiuUsers[0]?.id,
        startDate: '2025-02-01',
        endDate: '2025-12-31',
        timelineUpdateFrequency: 'weekly',
        timelineMilestones: 'Site preparation, foundation, construction, finishing',
        timelineProgress: 0.00,
        totalBudget: 15000000.00,
        budgetUpdateFrequency: 'monthly',
        budgetBreakdown: 'Construction: 80%, Equipment: 15%, Administrative: 5%',
        budgetProgress: 0.00,
        physicalUpdateFrequency: 'weekly',
        requiredDocumentation: 'Construction permits, progress reports, safety certificates',
        physicalProgressRequirements: 'Building construction, equipment installation',
        physicalProgress: 0.00,
        overallProgress: 0.00,
        projectManager: 'Engr. Roberto Cruz',
        contactNumber: '09123456786',
        specialRequirements: 'Educational facility standards, safety compliance',
        implementingOfficeId: implementingOffices[0]?.id,
        approvedBySecretariat: false,
        approvedByMPMEC: false,
        workflowStatus: 'submitted',
        submittedToSecretariat: true,
        submittedToSecretariatDate: new Date('2025-01-16'),
        createdAt: new Date('2025-01-16'),
        updatedAt: new Date('2025-01-16')
      }
    ];

    await queryInterface.bulkInsert('projects', projects, {});
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.bulkDelete('projects', null, {});
  }
}; 